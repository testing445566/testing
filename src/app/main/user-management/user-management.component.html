<section>
  <div class="common-page-heding-font">
    <h1 class="heading">User Management</h1>
    <p class="sub-heading">Manage employees and administrators</p>
  </div>

  <div class="user-management-search">
    <div class="management-search">
      <label for="userManageSearch">
        <svg
          xmlns="http://www.w3.org/2000/svg"
          viewBox="0 0 24 24"
          width="22"
          color="#adb3bd"
          fill="none"
        >
          <path
            d="M17 17L21 21"
            stroke="#adb3bd"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          ></path>
          <path
            d="M19 11C19 6.58172 15.4183 3 11 3C6.58172 3 3 6.58172 3 11C3 15.4183 6.58172 19 11 19C15.4183 19 19 15.4183 19 11Z"
            stroke="#adb3bd"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          ></path>
        </svg>
      </label>
      <input
        type="text"
        name="userSearch"
        id="userManageSearch"
        placeholder="Search users..."
        #search
        (input)="searchUser(search.value)"
      />
    </div>

    <button
      class="user-management-add-user-button"
      [ngClass]="addNewUserModalToggel && !update ? 'button-outline' : ''"
      (click)="openModal()"
    >
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        width="22"
        color="#ffffff"
        fill="none"
      >
        <path
          d="M15 8C15 5.23858 12.7614 3 10 3C7.23858 3 5 5.23858 5 8C5 10.7614 7.23858 13 10 13C12.7614 13 15 10.7614 15 8Z"
          stroke="#ffffff"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
        <path
          d="M17.5 21L17.5 14M14 17.5H21"
          stroke="#ffffff"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
        <path
          d="M3 20C3 16.134 6.13401 13 10 13C11.4872 13 12.8662 13.4638 14 14.2547"
          stroke="#ffffff"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
      </svg>
      Add User
    </button>
  </div>

  <div class="new-add-user" *ngIf="addNewUserModalToggel">
    <h4>{{ update ? "Update User" : "Add New User" }}</h4>
    <div class="form-container">
      <form class="form" [formGroup]="addUser">
        <div class="input-fields-container">
          <div class="input-field">
            <label for="name">
              <span>Full Name *</span>
              <input type="text" name="name" id="name" formControlName="name" />
            </label>
            <div
              class="validaction-add-new-user"
              *ngIf="
                form['name'].errors &&
                (form['name'].touched || form['name'].dirty)
              "
            >
              <span *ngIf="form['name'].errors['required']"
                >Full Name is required.</span
              >
            </div>
          </div>
          <div class="input-field">
            <label for="email">
              <span>Email Address *</span>
              <input
                type="email"
                name="email"
                id="email"
                formControlName="email"
              />
            </label>
            <div
              class="validaction-add-new-user"
              *ngIf="
                form['email'].errors &&
                (form['email'].touched || form['email'].dirty)
              "
            >
              <span *ngIf="form['email'].errors['required']"
                >Email is required.</span
              >
              <span *ngIf="form['email'].errors['pattern']"
                >Please enter valid email format.</span
              >
            </div>
          </div>
        </div>
        <div class="input-fields-container">
          <div class="input-field">
            <span>Role *</span>
            <select
              name="select-user-roll"
              class="roll-select"
              id="role"
              formControlName="role"
            >
              <option value="employee" selected="selected">Employee</option>
              <option value="admin">Admin</option>
            </select>
          </div>
          <div class="input-field">
            <label for="department">
              <span>Dipartment</span>
              <input
                type="text"
                name="department"
                id="department"
                formControlName="department"
              />
            </label>
            <div
              class="validaction-add-new-user"
              *ngIf="
                form['department'].errors &&
                (form['department'].touched || form['department'].dirty)
              "
            >
              <span *ngIf="form['department'].errors['required']"
                >Department is required.</span
              >
            </div>
          </div>
        </div>
        <div class="input-fields-container">
          <div class="input-field">
            <label for="position">
              <span>Position</span>
              <input
                type="text"
                name="position"
                id="position"
                formControlName="position"
              />
            </label>
            <div
              class="validaction-add-new-user"
              *ngIf="
                form['position'].errors &&
                (form['position'].touched || form['position'].dirty)
              "
            >
              <span *ngIf="form['position'].errors['required']"
                >Position is required.
              </span>
            </div>
          </div>
          <div class="input-field">
            <label for="phone">
              <span>Phone Number</span>
              <input
                type="number"
                name="phone"
                id="phone"
                formControlName="phone"
              />
            </label>
            <div
              class="validaction-add-new-user"
              *ngIf="
                form['phone'].errors &&
                (form['phone'].touched || form['phone'].dirty)
              "
            >
              <span *ngIf="form['phone'].errors['required']"
                >Phone Number is required.</span
              >
              <span *ngIf="form['phone'].errors['pattern']"
                >Only valid 10 number valid.</span
              >
            </div>
          </div>
        </div>
        <div class="input-fields-container">
          <div class="input-field">
            <label for="password">
              <span>Password *</span>
              <input
                type="password"
                name="password"
                id="password"
                formControlName="password"
              />
            </label>
            <div
              class="validaction-add-new-user"
              *ngIf="
                form['password'].errors &&
                (form['password'].touched || form['password'].dirty)
              "
            >
              <span *ngIf="form['password'].errors['required']"
                >Password is required.</span
              >
              <span *ngIf="form['password'].errors['pattern']"
                >Please create storng password using number, carecters and
                special chrecters.</span
              >
            </div>
          </div>
        </div>
      </form>
      <div class="new-user-add-button">
        <button class="cancel-button" (click)="closeModal()">Cancel</button>
        <button
          (click)="submitUser()"
          class="save-button"
          [ngClass]="addUser.invalid ? 'deseble-button' : ''"
          [disabled]="addUser.invalid"
        >
          <svg
            xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 24 24"
            width="20"
            color="#ffffff"
            fill="none"
          >
            <path
              d="M8 7L16 7"
              stroke="#ffffff"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            ></path>
            <path
              d="M8 11L12 11"
              stroke="#ffffff"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            ></path>
            <path
              d="M13 21.5V21C13 18.1716 13 16.7574 13.8787 15.8787C14.7574 15 16.1716 15 19 15H19.5M20 13.3431V10C20 6.22876 20 4.34315 18.8284 3.17157C17.6569 2 15.7712 2 12 2C8.22877 2 6.34315 2 5.17157 3.17157C4 4.34314 4 6.22876 4 10L4 14.5442C4 17.7892 4 19.4117 4.88607 20.5107C5.06508 20.7327 5.26731 20.9349 5.48933 21.1139C6.58831 22 8.21082 22 11.4558 22C12.1614 22 12.5141 22 12.8372 21.886C12.9044 21.8623 12.9702 21.835 13.0345 21.8043C13.3436 21.6564 13.593 21.407 14.0919 20.9081L18.8284 16.1716C19.4065 15.5935 19.6955 15.3045 19.8478 14.9369C20 14.5694 20 14.1606 20 13.3431Z"
              stroke="#ffffff"
              stroke-width="1.5"
              stroke-linecap="round"
              stroke-linejoin="round"
            ></path>
          </svg>
          Create User
        </button>
      </div>
    </div>
  </div>

  <div class="user-table-responsive">
    <div class="caption-top">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        viewBox="0 0 24 24"
        width="25"
        color="#000000"
        fill="none"
      >
        <path
          d="M16.5 20V17.9704C16.5 16.7281 15.9407 15.5099 14.8103 14.9946C13.4315 14.3661 11.7779 14 10 14C8.22212 14 6.5685 14.3661 5.18968 14.9946C4.05927 15.5099 3.5 16.7281 3.5 17.9704V20"
          stroke="#000000"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
        <path
          d="M20.5 20.001V17.9713C20.5 16.729 19.9407 15.5109 18.8103 14.9956C18.5497 14.8768 18.2792 14.7673 18 14.668"
          stroke="#000000"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
        <circle
          cx="10"
          cy="7.5"
          r="3.5"
          stroke="#000000"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></circle>
        <path
          d="M15 4.14453C16.4457 4.57481 17.5 5.91408 17.5 7.49959C17.5 9.0851 16.4457 10.4244 15 10.8547"
          stroke="#000000"
          stroke-width="1.5"
          stroke-linecap="round"
          stroke-linejoin="round"
        ></path>
      </svg>
      <h6>Users ({{ showDisplay.length }})</h6>
    </div>
    <table class="users-detail-table">
      <thead>
        <tr>
          <th>USER</th>
          <th>ROLE</th>
          <th>DEPARTMENT</th>
          <th>POSITION</th>
          <th>CREATED</th>
          <th class="table-thead-action">ACTIONS</th>
        </tr>
      </thead>
      <tbody>
        <tr
          *ngFor="let user of showDisplay; let last = last"
          [ngClass]="last ? 'border-bottom' : ''"
        >
          <td>
            <div class="role-card">
              <p>{{ user.name }}</p>
              <span>{{ user.email }}</span>
            </div>
          </td>
          <td>
            <span
              class="role-card"
              [ngClass]="
                user.role === 'admin'
                  ? 'admin-table-role'
                  : 'employee-table-role'
              "
            >
              {{ user.role }}
            </span>
          </td>
          <td>{{ user.department }}</td>
          <td>{{ user.position }}</td>
          <td class="create-date">{{ user.createdAt }}</td>
          <td>
            <div class="table-action-button">
              <button (click)="getUser(user.id)">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  width="23"
                  color="#5b8af0"
                  fill="none"
                >
                  <path
                    d="M16.4249 4.60509L17.4149 3.6151C18.2351 2.79497 19.5648 2.79497 20.3849 3.6151C21.205 4.43524 21.205 5.76493 20.3849 6.58507L19.3949 7.57506M16.4249 4.60509L9.76558 11.2644C9.25807 11.772 8.89804 12.4078 8.72397 13.1041L8 16L10.8959 15.276C11.5922 15.102 12.228 14.7419 12.7356 14.2344L19.3949 7.57506M16.4249 4.60509L19.3949 7.57506"
                    stroke="#5b8af0"
                    stroke-width="1.5"
                    stroke-linejoin="round"
                  ></path>
                  <path
                    d="M18.9999 13.5C18.9999 16.7875 18.9999 18.4312 18.092 19.5376C17.9258 19.7401 17.7401 19.9258 17.5375 20.092C16.4312 21 14.7874 21 11.4999 21H11C7.22876 21 5.34316 21 4.17159 19.8284C3.00003 18.6569 3 16.7712 3 13V12.5C3 9.21252 3 7.56879 3.90794 6.46244C4.07417 6.2599 4.2599 6.07417 4.46244 5.90794C5.56879 5 7.21252 5 10.5 5"
                    stroke="#5b8af0"
                    stroke-width="1.5"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  ></path>
                </svg>
              </button>
              <button *ngIf="!user?.master" (click)="deleteUser(user.id)">
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  viewBox="0 0 24 24"
                  width="23"
                  color="#e45353"
                  fill="none"
                >
                  <path
                    d="M19.5 5.5L18.8803 15.5251C18.7219 18.0864 18.6428 19.3671 18.0008 20.2879C17.6833 20.7431 17.2747 21.1273 16.8007 21.416C15.8421 22 14.559 22 11.9927 22C9.42312 22 8.1383 22 7.17905 21.4149C6.7048 21.1257 6.296 20.7408 5.97868 20.2848C5.33688 19.3626 5.25945 18.0801 5.10461 15.5152L4.5 5.5"
                    stroke="#e45353"
                    stroke-width="1.5"
                    stroke-linecap="round"
                  ></path>
                  <path
                    d="M3 5.5H21M16.0557 5.5L15.3731 4.09173C14.9196 3.15626 14.6928 2.68852 14.3017 2.39681C14.215 2.3321 14.1231 2.27454 14.027 2.2247C13.5939 2 13.0741 2 12.0345 2C10.9688 2 10.436 2 9.99568 2.23412C9.8981 2.28601 9.80498 2.3459 9.71729 2.41317C9.32164 2.7167 9.10063 3.20155 8.65861 4.17126L8.05292 5.5"
                    stroke="#e45353"
                    stroke-width="1.5"
                    stroke-linecap="round"
                  ></path>
                  <path
                    d="M9.5 16.5L9.5 10.5"
                    stroke="#e45353"
                    stroke-width="1.5"
                    stroke-linecap="round"
                  ></path>
                  <path
                    d="M14.5 16.5L14.5 10.5"
                    stroke="#e45353"
                    stroke-width="1.5"
                    stroke-linecap="round"
                  ></path>
                </svg>
              </button>
            </div>
          </td>
        </tr>
        <tr *ngIf="showDisplay.length < 1" class="border-bottom">
          <td colspan="6">
            <div class="no-data-found">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                width="48 "
                height="48"
                viewBox="0 0 24 24"
                fill="none"
                stroke="#d1d5db"
                stroke-width="2"
                stroke-linecap="round"
                stroke-linejoin="round"
                class="lucide lucide-users h-12 w-12 mx-auto mb-3 text-gray-300"
              >
                <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"></path>
                <circle cx="9" cy="7" r="4"></circle>
                <path d="M22 21v-2a4 4 0 0 0-3-3.87"></path>
                <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
              </svg>
              <p>No users found</p>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</section>
